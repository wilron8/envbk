/*
 * File: envitz/view/Registration.js
 *
 * This file was generated by Sencha Architect version 3.0.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('envitz.view.Registration', {
	extend: 'Ext.container.Container',
	alias: 'widget.userRegForm',

	requires: [
		'envitz.view.ComboSearchMultiFields',
		'envitz.view.PasswordMeter',
		'envitz.view.securityQuestionAnswer',
		'Ext.form.Label',
		'Ext.tab.Panel',
		'Ext.form.Panel',
		'Ext.tab.Tab',
		'Ext.form.field.Display',
		'Ext.form.field.ComboBox',
		'Ext.form.field.Checkbox'
	],

	border: false,

	initComponent: function() {
		var me = this;

		Ext.applyIf(me, {
			style: {
				backgroundColor: '#fff'
			},
			items: [
				{
					xtype: 'label',
					margin: '0 0 -10 5',
					style: {
						fontSize: 'large'
					},
					text: 'Registration'
				},
				{
					xtype: 'tabpanel',
					tabBar: {
						xtype: 'tabbar',
						border: 0,
						minWidth: 100,
						plain: true,
						layout: {
							type: 'hbox',
							align: 'stretch',
							pack: 'end'
						}
					},
					border: 0,
					margin: 5,
					defaults: {
						anchor: '100%'
					},
					activeTab: 0,
					minTabWidth: 100,
					plain: true,
					items: [
						{
							xtype: 'form',
							itemId: 'registrationForm',
							defaults: {
								//anchor: '100%',
								padding: '5px'
							},
							title: 'Edit',
							items: [
								{
									xtype: 'container',
									itemId: 'joinName1',
									layout: {
										type: 'vbox',
										align: 'stretch',
										defaultMargins: {
											top: 05,
											right: 05,
											bottom: 05,
											left: 0
										}
									},
									items: [
										me.processJoinWelcomeMsg({
											xtype: 'container',
											margins: '3',
											height: 50,
											html: 'Hello %userDisplayName%, Welcome to Linspira.<BR>Please provide the following information to complete your registration.<BR><BR>',
											id: 'joinWelcomeMsg',
											layout: 'anchor'
										}),
										{
											xtype: 'displayfield',
											itemId: 'joinEmail',
											width: 400,
											fieldLabel: 'Email',
											name: 'email',
											value: '%userVerifiedEmail%'
										}
									]
								},
								{
									xtype: 'container',
									layout: {
										type: 'hbox',
										align: 'stretch',
										defaultMargins: {
											top: 0,
											right: 10,
											bottom: 0,
											left: 0
										}
									},
									items: [
										{
											xtype: 'textfield',
											showClear: true,
											flex: 1,
											itemId: 'joinName1',
											fieldLabel: 'Full Name',
											name: 'usr_fName',
											allowBlank: false,
											blankText: 'Please type in your First name.',
											emptyText: 'First Name',
											enforceMaxLength: true,
											maxLength: 128,
											minLength: 1,
											selectOnFocus: true
										},
										{
											xtype: 'textfield',
											plugins: '',
											flex: 1,
											itemId: 'joinName2',
											name: 'usr_mName',
											emptyText: 'Middle ( Optional )',
											enforceMaxLength: true,
											maxLength: 64,
											selectOnFocus: true
										},
										{
											xtype: 'textfield',
											showClear: true,
											flex: 1,
											itemId: 'joinName3',
											name: 'usr_lName',
											allowBlank: false,
											blankText: 'Please type in your Last name',
											emptyText: 'Last Name',
											enforceMaxLength: true,
											maxLength: 128,
											minLength: 1,
											selectOnFocus: true
										}
									]
								},
								{
									xtype: 'container',
									layout: {
										type: 'vbox',
										align: 'stretch',
										defaultMargins: {
											top: 0,
											right: 10,
											bottom: 0,
											left: 0
										}
									},
									items: [
										{
											xtype: 'textfield',
											flex: 1,
											itemId: 'joinAddress1',
											margin: '0 0 5 0',
											fieldLabel: 'Address',
											name: 'uAddr_address1',
											emptyText: 'Street Address 1',
											enforceMaxLength: true,
											maxLength: 128,
											minLength: 3,
											selectOnFocus: true
										},
										{
											xtype: 'textfield',
											flex: 1,
											itemId: 'joinAddress2',
											fieldLabel: '&nbsp;',
											labelSeparator: '&nbsp;',
											name: 'uAddr_address2',
											emptyText: 'Street Address 2 ( Optional )',
											enforceMaxLength: true,
											maxLength: 128,
											selectOnFocus: true
										},
										{
											xtype: 'textfield',
											listConfig: {
												loadingText: 'Asking Wikipedia for the list...',
												//emptyText: "Wikipedia has no Cities?",
												getInnerTpl: function() {
													return '<tpl for="."><div data-qtip="[{geoCity_id}] {geoCity_ISO3166}"> {geoCity_cityName}</div></tpl>';
												}
											},
											flex: 2,
											itemId: 'joinAddrCity',
											maxHeight: 400,
											fieldLabel: '&nbsp;',
											labelSeparator: '&nbsp;',
											name: 'uAddr_city',
											blankText: 'Please select your city or type it in.',
											emptyText: 'City'
										},
										{
											xtype: 'container',
											flex: 1,
											layout: {
												type: 'hbox',
												align: 'stretch',
												defaultMargins: {
													top: 0,
													right: 0,
													bottom: 05,
													left: 0
												}
											},
											items: [
												{
													xtype: 'combosearchmultifields',
													listConfig: {
														loadingText: 'Populating list...',
														//emptyText: "Wikipedia has no States/Provences?",
														getInnerTpl: function() {
															return '<tpl for="."><div data-qtip="[{geoStateCity_id}] {geoStateCity_ISO3166_2} / {geoStateCity_roman}"> {geoStateCity_cityState}</div></tpl>';
														}
													},
													searchFields: [
														'geoStateCity_cityState',
														'geoStateCity_roman',
														'geoStateCity_demonym',
														'geoStateCity_ISO3166'
													],
													itemId: 'joinAddrState',
													margin: '0 5 0 0',
													maxHeight: 400,
													fieldLabel: '&nbsp;',
													labelSeparator: '&nbsp;',
													name: 'uAddr_state',
													blankText: 'Please select a State/Province',
													emptyText: 'State / Province',
													displayField: 'geoStateCity_cityState',
													queryDelay: 150,
													store: 'stateCity',
													valueField: 'geoStateCity_id',
													flex: 1
												},
												{
													xtype: 'textfield',
													itemId: 'joinAddrZIP',
													name: 'uAddr_ZIP',
													blankText: 'Type in your Postal / ZIP code.',
													emptyText: 'Zip / Postal code',
													enforceMaxLength: true,
													maskRe: /[\w\-\+_A-Za-z0-9\.]/,
													selectOnFocus: true
												}
											]
										},
										{
											xtype: 'combosearchmultifields',
											displayTpl: '<tpl for=".">{geoContinent_region} / {geoCountry_roman} ( {geoCountry_name} )</tpl>',
											listConfig: {
												loadingText: 'Populating list...',
												//emptyText: "Wikipedia has no Countries?",
												getInnerTpl: function() {
													return '<tpl for="."><div data-qtip="[{geoCountry_id}] {geoContinent_region} / {geoCountry_roman}">{geoContinent_region} / {geoCountry_name} <IMG style="float:right" src="/images/icons/flags/{geoCountry_flagImg}" /></div></tpl>';
												}
											},
											searchFields: [
												'geoCountry_roman',
												'geoCountry_name',
												'geoCountry_ISO3166',
												'geoContinent_region'
											],
											itemId: 'joinAddrCountry',
											maxHeight: 400,
											width: 300,
											fieldLabel: '&nbsp;',
											labelSeparator: '&nbsp;',
											name: 'uAddr_country',
											blankText: 'Please select a country.',
											emptyText: 'Select Country',
											displayField: 'geoCountry_name',
											store: 'countries',
											valueField: 'geoCountry_id',
											valueNotFoundText: 'Please select from the list of Countries'
										}
									]
								},
								{
									xtype: 'container',
									itemId: 'joinPhones1',
									items: [
										{
											xtype: 'container',
											layout: {
												type: 'hbox',
												align: 'stretch',
												defaultMargins: {
													top: 0,
													right: 10,
													bottom: 0,
													left: 0
												}
											},
											items: [
												{
													xtype: 'combobox',
													itemId: 'joinPhoneType',
													maxWidth: 250,
													minWidth: 200,
													fieldLabel: 'Telephone',
													name: 'uPhon_type',
													value: 'Primary',
													emptyText: 'Type',
													maskRe: /[\w\-\+_A-Za-z0-9\.]/,
													queryMode: 'local',
													store: 'phoneType',
													valueField: 'id'
												},
												{
													xtype: 'textfield',
													itemId: 'joinPhoneCallCode',
													maxWidth: 100,
													width: 90,
													name: 'uPhon_countryCode',
													emptyText: 'Country Code',
													enforceMaxLength: true,
													maskRe: /[\w\-\+0-9\.]/,
													maxLength: 16
												},
												{
													xtype: 'textfield',
													itemId: 'joinPhoneAreacode',
													maxWidth: 100,
													width: 90,
													name: 'uPhon_areaCode',
													emptyText: 'Area Code',
													enforceMaxLength: true,
													maskRe: /[\w\-\+0-9\.]/,
													maxLength: 16
												},
												{
													xtype: 'textfield',
													flex: 1,
													itemId: 'joinPhoneNumber',
													maxWidth: 200,
													width: 200,
													name: 'uPhon_number',
													emptyText: '989-7654',
													enforceMaxLength: true,
													maskRe: /[\w\-\+0-9\.]/,
													maxLength: 32,
													selectOnFocus: true
												}
											]
										}
									]
								},
								me.processLang({
									xtype: 'combosearchmultifields',
									searchFields: [
										'geoLang_name',
										'geoLang_roman',
										'geoLang_ISO639'
									],
									maxHeight: 200,
									minWidth: 350,
									fieldLabel: 'Language',
									name: 'usr_lang',
									emptyText: 'Select Language',
									enforceMaxLength: false,
									displayField: 'geoLang_name',
									store: 'languages',
									valueField: 'geoLang_id',
									valueNotFoundText: 'Language not supported, please select from this list'
								}),
								{
									xtype: 'passwordMeter'
								},
								{
									xtype: 'container',
									layout: {
										type: 'hbox',
										align: 'stretch'
									},
									items: [
										{
											xtype: 'container',
											html: 'Are you Human? ',
											minWidth: 100,
											width: 100
										},
										{
											xtype: 'container',
											flex: 1,
											height: 140,
											itemId: 'captchaHolder'
										}
									]
								},
								{
									xtype: 'securityQuestionAnswer'
								},
								{
									xtype: 'checkboxfield',
									itemId: 'joinTOS',
									margin: '10 0 0 100',
									name: 'agreement',
									boxLabel: 'I agree to the <A class="term_of_service" href="/legal/tos.php" >terms of service</A>.',
									checked: true,
									inputValue: '1',
									uncheckedValue: '0'
								}
							]
						},
						{
							xtype: 'panel',
							itemId: 'previewPanel',
							title: 'Preview',
							items: [
								{
									xtype: 'form',
									border: false,
									itemId: 'preview',
									header: false,
									title: 'Preview',
									items: [
										{
											xtype: 'container',
											itemId: 'joinName2',
											layout: {
												type: 'vbox',
												align: 'stretch',
												defaultMargins: {
													top: 05,
													right: 05,
													bottom: 05,
													left: 0
												},
												padding: 5
											},
											items: [
												me.processWelcomeMsg({
													xtype: 'container',
													margins: '3',
													height: 50,
													html: 'Hello %userFullName%, Welcome to Linspira.<BR>Please <i>confirm</i> the following information to complete your registration.<BR><BR>',
													id: 'welcomeMsg',
													layout: 'anchor'
												}),
												{
													xtype: 'displayfield',
													itemId: 'userEmail',
													width: 400,
													fieldLabel: 'Email',
													name: 'email',
													value: '%userVerifiedEmail%'
												},
												{
													xtype: 'displayfield',
													itemId: 'userFullName',
													width: 400,
													fieldLabel: 'Full Name',
													value: '%userFullName%'
												},
												{
													xtype: 'displayfield',
													itemId: 'userAddress1',
													width: 400,
													fieldLabel: 'Address',
													name: 'uAddr_address1',
													value: '%userAddr1%'
												},
												{
													xtype: 'displayfield',
													itemId: 'userAddress2',
													width: 400,
													fieldLabel: '&nbsp;',
													labelSeparator: '&nbsp;',
													name: 'uAddr_address2',
													value: '%userAddr2%'
												},
												{
													xtype: 'displayfield',
													itemId: 'userAddress3',
													width: 400,
													fieldLabel: '&nbsp;',
													labelSeparator: '&nbsp;',
													value: '%userAddr2%'
												},
												{
													xtype: 'container',
													flex: 1,
													layout: {
														type: 'hbox',
														align: 'stretch'
													},
													items: [
														{
															xtype: 'label',
															flex: 1,
															maxWidth: 105,
															width: 105,
															text: 'Telephone:'
														},
														{
															xtype: 'displayfield',
															itemId: 'phoneType',
															fieldLabel: '',
															name: 'uPhon_type',
															value: 'Display Field'
														},
														{
															xtype: 'displayfield',
															margins: '0 0 0 5',
															fieldLabel: '',
															name: 'uPhon_countryCode',
															value: 'Display Field'
														},
														{
															xtype: 'displayfield',
															margin: '0 0 0 5',
															fieldLabel: '',
															name: 'uPhon_areaCode',
															value: 'Display Field'
														},
														{
															xtype: 'displayfield',
															margin: '0 0 0 5',
															fieldLabel: '',
															name: 'uPhon_number',
															value: 'Display Field'
														}
													]
												},
												{
													xtype: 'displayfield',
													itemId: 'userLang',
													width: 400,
													fieldLabel: 'Language',
													value: '%userLang%'
												},
												{
													xtype: 'displayfield',
													itemId: 'userSecretQ',
													width: 400,
													fieldLabel: 'Secret Q&A',
													name: 'usr_secretQ',
													value: '%userSecretQ%'
												},
												{
													xtype: 'displayfield',
													itemId: 'userSecretA',
													width: 400,
													fieldLabel: '&nbsp;',
													labelSeparator: '&nbsp;',
													name: 'usr_secretA',
													value: '%userSecretA%'
												}
											]
										}
									]
								}
							]
						}
					]
				},
				{
					xtype: 'container',
					margin: '30 0 0 100',
					padding: 5,
					items: [
						{
							xtype: 'button',
							itemId: 'btnSubmitRegistration',
							minWidth: 100,
							text: 'Join!'
						},
						{
							xtype: 'button',
							itemId: 'btnResetRegistration',
							id: 'btnResetRegistration',
							margin: '0 0 0 20',
							minWidth: 100,
							text: 'Clear'
						}
					]
				}
			]
		});

		me.callParent(arguments);
	},

	processJoinWelcomeMsg: function(config) {
		config.html = "Hello " + LApp.formData.fullname + ", Welcome to Linspira!<BR>Please <i>confirm</i> the following information to complete your registration.<BR><BR>";
		return config;
	},

	processLang: function(config) {
		var store = Ext.StoreMgr.lookup('languages');

		if (Ext.isGecko) console.log("processLang:: lookup(languages)");

		store.clearFilter(true);
		store.filter('geoLang_isSupported',1);

		config.store=store;

		return config;
	},

	processWelcomeMsg: function(config) {
		config.html = "Hello " + LApp.formData.fullname + ", Welcome to Linspira!<BR>Please <i>confirm</i> the following information to complete your registration.<BR><BR>";
		return config;
	}

});