/*
 * File: envitz/view/ForgotPassword.js
 *
 * This file was generated by Sencha Architect version 3.0.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('envitz.view.ForgotPassword', {
	extend: 'Ext.window.Window',

	requires: [
		'Ext.form.Panel',
		'Ext.form.field.Text',
		'Ext.button.Button'
	],

	maxHeight: 200,
	maxWidth: 400,
	layout: 'fit',
	title: 'Forgot Password?',

	initComponent: function() {
		var me = this;

		Ext.applyIf(me, {
			items: [
				{
					xtype: 'form',
					border: false,
					bodyPadding: 10,
					header: false,
					title: 'My Form',
					items: [
						{
							xtype: 'textfield',
							anchor: '100%',
							margin: '15 0 15 0',
							maxWidth: 300,
							width: 300,
							fieldLabel: 'Enter your registered email address:',
							labelAlign: 'top',
							name: 'email',
							inputType: 'email',
							allowBlank: false,
							vtype: 'email',
							vtypeText: 'Please type a valid email.'
						},
						{
							xtype: 'button',
							handler: function(button, e) {
								//TODO: we should use the Ext.Msg.prompt() method here since we have no further advaced processing here...
								//		We simply don't need a window call when prompt will perform the same utility.

								var form = button.up('form').getForm();

								form.submit({
									waitMsg:'checking...',
									url:LApp.basePath+'/forgot',
									success: function (form, action) {
										var svrMsg = Ext.JSON.decode(action.response.responseText);

										me.removeAll();
										me.add({
											xtype: 'label',
											html: svrMsg.msg,
											padding: '10 0 0 10',
											style: {
												backgroundColor: 'white',
												display: 'block'
											}
										});

										//console.log('response: '+action.response.responseText);
									},

									failure: function (form,action) {
										var svrMsg = Ext.JSON.decode(action.response.responseText);
										//me.down('#msg').setText(svrMsg.msg);										
										Ext.Msg.alert('Message Response', svrMsg.msg);
										//console.log(me.down('#msg'));
										//Ext.getCmp('#msg').setText(svrMsg.msg);
										//Ext.form.Label('')
										//me.down('#msg').setText(svrMsg.msg);
										
									}

								});
							},
							formBind: true,
							margin: '0 10 0 105',
							width: 60,
							text: 'Send'
						},
						{
							xtype: 'button',
							handler: function(button, e) {
								me.close();
							},
							width: 60,
							text: 'Cancel'
						}
					]
				}
			]
		});

		me.callParent(arguments);
	}

});